@model IEnumerable<Firma.Data.Data.Towar>

@{
    ViewData["Title"] = "Sklep z Herbatą";
}

<h3 class="center-align header teal-text">Nasze Herbaty</h3>
<div class="row section grey lighten-4" style="padding: 20px; border-radius: 10px;">
    <form asp-action="Index" method="get">

        <div class="input-field col s12 m5">
            <i class="material-icons prefix">search</i>
            <input type="text" name="szukanaFraza" id="szukanaFraza" value="@ViewBag.Fraza" />
            <label for="szukanaFraza">Szukaj herbaty...</label>
        </div>

        <div class="input-field col s12 m4">
            <select name="idRodzaju" asp-items="ViewBag.Rodzaje">
                <option value="">Wszystkie kategorie</option>
            </select>
            <label>Wybierz kategorię</label>
        </div>

        <div class="col s12 m3 center-align" style="margin-top: 20px;">
            <button type="submit" class="btn waves-effect waves-light teal darken-2">
                Filtruj
                <i class="material-icons right">filter_list</i>
            </button>
        </div>

    </form>
</div>
<div class="row">

    <div class="col s12 m9">
        <div class="row" style="display: flex; flex-wrap: wrap;">
            @foreach (var towar in Model)
            {
                <div class="col s12 m4" style="margin-bottom: 20px;">
                    <div class="card hoverable" style="height: 100%; display: flex; flex-direction: column;">

                        <div class="card-image">
                            <img src="/Content/Images/@towar.FotoURL"
                                 onerror="this.src='https://placehold.co/300x200?text=Brak+Zdjecia'"
                                 style="height: 200px; object-fit: cover;">
                            <a asp-controller="Koszyk" asp-action="DodajDoKoszyka" asp-route-id="@towar.IdTowaru"
                               class="btn-floating halfway-fab waves-effect waves-light red">
                                <i class="material-icons">add_shopping_cart</i>
                            </a>
                        </div>

                        <div class="card-content" style="flex-grow: 1;">
                            <span class="card-title truncate" style="font-size: 1.2em">@towar.Nazwa</span>
                            <span class="teal-text font-weight-bold">@towar.Cena zł</span>
                        </div>

                        @if (towar.TowarTagi != null && towar.TowarTagi.Any())
                        {
                            <div class="grey lighten-5" style="padding: 10px; border-top: 1px solid #e0e0e0; min-height: 50px;">
                                @foreach (var tag in towar.TowarTagi.Select(tt => tt.Tag))
                                {
                                    string badgeClass = "grey lighten-1 white-text";
                                    if (tag.Nazwa.ToLower().Contains("promocja")) { badgeClass = "red white-text"; }
                                    else if (tag.Nazwa.ToLower().Contains("nowość")) { badgeClass = "green white-text"; }
                                    else if (tag.Nazwa.ToLower().Contains("bio")) { badgeClass = "green lighten-2 white-text"; }
                                    else if (tag.Nazwa.ToLower().Contains("hit")) { badgeClass = "orange black-text"; }

                                    <span class="new badge @badgeClass" data-badge-caption="@tag.Nazwa"
                                          style="float:none; margin-right: 5px; border-radius: 4px;"></span>
                                }
                            </div>
                        }
                        else
                        {
                        }

                    </div>
                </div>
            }
        </div>
    </div>
   
    <div class="col s12 m3">
        <h5 class="teal-text"><i class="material-icons left">announcement</i>Aktualności</h5>

        @if (ViewBag.Aktualnosci != null)
        {
            foreach (var news in ViewBag.Aktualnosci as IEnumerable<Firma.Data.Data.Aktualnosc>)
            {
                <div class="card blue-grey darken-1">
                    <div class="card-content white-text">
                        <span class="card-title" style="font-size: 1.1em">@news.TytulTresci</span>
                        <p style="font-size: 0.9em;">@news.Tresc</p>
                    </div>
                    <div class="card-action">
                        <a href="#" class="yellow-text">@news.TytulOdnosnika</a>
                    </div>
                </div>
            }
        }
    </div>

</div>